# 1.RequestParam

## 1.1 使用说明

**作用:**	把请求中指定名称的参数给控制器中的形参赋值

**属性：**

​	**value：**请求参数中的名称

​	**required：**请求参数是否必须提供此参数。默认值：true，表示必须提供，如果不提供将报错

## 1.2 使用示例

**jsp代码**

```jsp
<!-- requestParams 注解的使用 -->
<a href="springmvc/useRequestParam?name=test">requestParam 注解</a>
```

**控制器代码**

```java
/**
* requestParams 注解的使用
* @param username
* @return
*/
@RequestMapping("/useRequestParam")
public String useRequestParam(@RequestParam("name")String username,
                              @RequestParam(value="age",required=false)Integer age){
    System.out.println(username+","+age);
    return "success";
}
```

# 2.RequestBody

## 2.1 使用说明

**作用：**用于获取请求体内容。直接使用得到是 key=value&key=value...结构的数据。(**get 请求方式不适用**)

**属性：**

​	**required：**是否必须有请求体。默认值是:true。当取值为 true 时,get 请求方式会报错。如果取值为 false，get 请求得					  到是 null。

## 2.2 使用示例

**post请求jsp代码**

```jsp
<!-- request body 注解 -->
<form action="springmvc/useRequestBody" method="post">
    用户名称：<input type="text" name="username" ><br/>
    用户密码：<input type="password" name="password" ><br/>
    用户年龄：<input type="text" name="age" ><br/>
    <input type="submit" value=" 保存 ">
</form>
```

**get请求jsp代码**

```jsp
<a href="springmvc/useRequestBody?body=test">requestBody 注解 get 请求</a>
```

**控制器代码**

```java
/**
* RequestBody 注解
* @param user
* @return
*/
@RequestMapping("/useRequestBody")
public String useRequestBody(@RequestBody(required=false) String body){
    System.out.println(body);
    return "success";
}
```

# 3.PathVaribale

## 3.1 使用说明

**作用：** 

​		用于绑定 url 中的占位符。例如：请求 url 中 /delete/{id}，这个{id}就是 url 占位符。

​		url 支持占位符是 spring3.0 之后加入的。是 SpringMVC支持 RESTful风格 URL 的一个重要标志。

**属性：**

​		**value：**用于指定 url 中占位符名称。
​		**required：**是否必须提供占位符。

## 3.2 使用示例

**jsp代码**

```jsp
<!-- PathVariable 注解 -->
<a href="springmvc/usePathVariable/100">pathVariable 注解</a>
```

**控制器代码**

```java
/**
* PathVariable 注解
* @param user
传智播客——专注于 Java、.Net 和Php、网页平面设计工程师的培训
北京市昌平区建材城西路金燕龙办公楼一层 电话：400-618-9090
* @return
*/
@RequestMapping("/usePathVariable/{id}")
public String usePathVariable(@PathVariable("id") Integer id){
    System.out.println(id);
    return "success";
}
```

## 3.3 RESTful风格URL

### 1.**什么是REST**

REST（英文：Representational State Transfer，简称 REST）描述了一个架构样式的网络系统，比如 web 应用程序。它首次出现在 2000 年 Roy Fielding 的博士论文中，他是 HTTP 规范的主要编写者之一。在目前主流的三种 Web 服务交互方案中，REST 相比于 SOAP（Simple Object Access protocol，简单对象访问协议）以及 XML-RPC 更加简单明了，无论是对 URL 的处理还是对 Payload 的编码，REST 都倾向于用更加简单轻量的方法设计和实现。值得注意的是 REST 并没有一个明确的标准，而更像是一种设计的风格。

它本身并没有什么实用性，其核心价值在于如何设计出符合 REST 风格的网络接口。

### 2.**RESTful的优点**

它结构清晰、符合标准、易于理解、扩展方便，所以正得到越来越多网站的采用。

### 3.**RESTful的特性**

**资源（ Resources）**：网络上的一个实体，或者说是网络上的一个具体信息。
		它可以是一段文本、一张图片、一首歌曲、一种服务，总之就是一个具体的存在。可以用一个 URI（统一资源定位		符）指向它，每种资源对应一个特定的 URI 。要获取这个资源，访问它的 URI 就可以，因此 URI 即为每一个资源的		独一无二的识别符。

**表现层（ Representation）：把资源具体呈现出来的形式**，叫做它的表现层 （ Representation）。
		比如，文本可以用 txt 格式表现，也可以用 HTML 格式、XML 格式、JSON 格式表现，甚至可以采用二进制格式。

**状态转化（ State Transfer）**：每发出一个请求，就代表了客户端和服务器的一次交互过程。
		HTTP 协议，是一个无状态协议，即所有的状态都保存在服务器端。因此，如果客户端想要操作服务器，必须通过某		种手段，让服务器端发生 “状态转化 ”（ State Transfer）。而这种转化是建立在表现层之上的，所以就是 “表现层状		态转化 ”。具体说，就是 **HTTP 协议里面，四个表示操作方式的动词： GET、 POST、 PUT、DELETE。它们分别		对应四种基本操作： GET 用来获取资源， POST 用来新建资源， PUT 用来更新资源， DELETE 用来删除资源。**

### 4.**RESTful的示例**

|    URL     |  请求方式   |       结果        |
| :--------: | :---------: | :---------------: |
| /account/1 |  HTTP GET   | 得到id=1的account |
| /account/1 | HTTP DELETE | 删除id=1的account |
| /account/1 |  HTTP PUT   | 更新id=1的account |
|  /account  |  HTTP POST  |    新增account    |

## 3.4 基于HiddentHttpMethodFilter的示例

**作用：**

由于浏览器 form 表单只支持 GET 与 POST 请求，而 DELETE、PUT 等 method 并不支持，Spring3.0 添加了一个过滤器，可以将浏览器请求改为指定的请求方式，发送给我们的控制器方法，使得支持 GET、POST、PUT与 DELETE 请求。

**使用方法：**

第一步：在 web.xml 中配置该过滤器。
第二步：请求方式必须使用 post 请求。
第三步：按照要求提供_method 请求参数，该参数的取值就是我们需要的请求方式。

**源码分析：**

![](https://gitee.com/krislin_zhao/IMGcloud/raw/master/img/20200724113024.png)

**jsp代码**

```jsp
<!-- 保存 -->
<form action="springmvc/testRestPOST" method="post">
    用户名称：<input type="text" name="username"><br/>
    <!-- <input type="hidden" name="_method" value="POST"> -->
    <input type="submit" value=" 保存 ">
</form>
<hr/>
<!-- 更新 -->
<form action="springmvc/testRestPUT/1" method="post">
    用户名称：<input type="text" name="username"><br/>
    <input type="hidden" name="_method" value="PUT">
    <input type="submit" value=" 更新 ">
</form>
<hr/>
<!-- 删除 -->
<form action="springmvc/testRestDELETE/1" method="post">
    <input type="hidden" name="_method" value="DELETE">
    <input type="submit" value=" 删除 ">
</form>
<hr/>
<!-- 查询一个 -->
<form action="springmvc/testRestGET/1" method="post">
    <input type="hidden" name="_method" value="GET">
    <input type="submit" value=" 查询 ">
</form>
```

**控制器代码**

```java
/**
* post 请求：保存
* @param username
* @return
*/
@RequestMapping(value="/testRestPOST",method=RequestMethod.POST)
public String testRestfulURLPOST(User user){
    System.out.println("rest post"+user);
    return "success";
}
/**
* put 请求：更新
* @param username
* @return
*/
@RequestMapping(value="/testRestPUT/{id}",method=RequestMethod.PUT)
public String testRestfulURLPUT(@PathVariable("id")Integer id,User user){
    System.out.println("rest put "+id+","+user);
    return "success";
}
/**
* post 请求：删除
* @param username
* @return
*/
@RequestMapping(value="/testRestDELETE/{id}",method=RequestMethod.DELETE)
public String testRestfulURLDELETE(@PathVariable("id")Integer id){
    System.out.println("rest delete "+id);
    return "success";
}
/**
* post 请求：查询
* @param username
* @return
*/
@RequestMapping(value="/testRestGET/{id}",method=RequestMethod.GET)
public String testRestfulURLGET(@PathVariable("id")Integer id){
    System.out.println("rest get "+id);
    return "success";
}
```

# 4.RequestHeader

## 4.1 使用说明

**作用：**用于获取请求消息头

**属性：**

​	**value：**提供消息头名称

​	**required：**是否必须有此消息头

> 一般开发中不怎么使用

## 4.2 使用示例

**jsp代码**

```jsp
<!-- RequestHeader 注解 -->
<a href="springmvc/useRequestHeader">获取请求消息头</a>
```

**控制器代码**

```java
/**
* RequestHeader 注解
* @param user
* @return
*/
@RequestMapping("/useRequestHeader")
public String useRequestHeader(@RequestHeader(value="Accept-Language",required=false)String requestHeader){
	System.out.println(requestHeader);
	return "success";
}
```

# 5.CookieValue

## 5.1 使用说明

**作用：**用于把指定cookie名称的值传入控制器方法参数

**属性：**

​	**value：**指定cookie的名称

​	**required：**是否必须有此cookie

## 5.2 使用示例

**jsp代码**

```jsp
<!-- CookieValue 注解 -->
<a href="springmvc/useCookieValue">绑定 cookie 的值</a>
```

**控制器代码**

```java
/**
* Cookie 注解注解
* @param user
* @return
*/
@RequestMapping("/useCookieValue")
public String useCookieValue(@CookieValue(value="JSESSIONID",required=false)String cookieValue){
    System.out.println(cookieValue);
    return "success";
}
```

# 6.ModelAttribute

## 6.1 使用说明

**作用：**

​	该注解是 SpringMVC4.3 版本以后新加入的。它可以用于修饰方法和参数。出现在方法上，表示当前方法会在控制器的	方法执行之前，先执行。它可以修饰没有返回值的方法，也可以修饰有具体返回值的方法。
​	出现在参数上，获取指定的数据给参数赋值。

**属性：**

​	**value：**用于获取数据的 key。key 可以是 POJO 的属性名称，也可以是 map 结构的 key。

**应用场景：**

​	当表单提交数据不是完整的实体类数据时，保证没有提交数据的字段使用数据库对象原来的数据。

​	例如：
​	我们在编辑一个用户时，用户有一个创建信息字段，该字段的值是不允许被修改的。在提交表单数据是肯定没有此字段	的内容，一旦更新会把该字段内容置为 null，此时就可以使用此注解解决问题。

## 6.2 使用示例

### 1.基于POJO属性的基本使用

**jsp代码**

```jsp
<!-- ModelAttribute 注解的基本使用 -->
<a href="springmvc/testModelAttribute?username=test">测试 modelattribute</a>
```

**控制器代码**

```java
/**
* 被 ModelAttribute 修饰的方法
* @param user
*/
@ModelAttribute
public void showModel(User user) {
	System.out.println("执行了 showModel 方法"+user.getUsername());
}
/**
* 接收请求的方法
* @param user
* @return
*/
@RequestMapping("/testModelAttribute")
public String testModelAttribute(User user) {
    System.out.println("执行了控制器的方法"+user.getUsername());
    return "success";
}
```

### 2.基于Map的应用场景1：ModelAttribute修饰方法带返回值

**需求：**

​	修改用户信息，要求用户的密码不能修改

**jsp代码**

```jsp
<form action="springmvc/updateUser" method="post">
    用户名称：<input type="text" name="username" ><br/>
    用户年龄：<input type="text" name="age" ><br/>
    <input type="submit" value=" 保存 ">
</form>
```

**控制器代码**

```java
/**
* 查询数据库中用户信息
* @param user
*/
@ModelAttribute
public User showModel(String username) {
    //模拟去数据库查询
    User abc = findUserByName(username);
    System.out.println("执行了 showModel 方法"+abc);
    return abc;
}
/**
* 模拟修改用户方法
* @param user
* @return
*/
@RequestMapping("/updateUser")
public String testModelAttribute(User user) {
    System.out.println("控制器中处理请求的方法：修改用户："+user);
    return "success";
}
/**
* 模拟去数据库查询
* @param username
* @return
*/
private User findUserByName(String username) {
    User user = new User();
    user.setUsername(username);
    user.setAge(19);
    user.setPassword("123456");
    return user;
}
```

### 3.基于Map的应用场景2 ：ModelAttribute修饰方法 不 带返回值

**需求：**

​	修改用户信息，要求用户的密码不能修改

**jsp代码**

```jsp
<!-- 修改用户信息 -->
<form action="springmvc/updateUser" method="post">
    用户名称：<input type="text" name="username" ><br/>
    用户年龄：<input type="text" name="age" ><br/>
    <input type="submit" value=" 保存 ">
</form>
```

**控制器代码**

```java
/**
* 查询数据库中用户信息
* @param user
*/
@ModelAttribute
public void showModel(String username,Map<String,User> map) {
    //模拟去数据库查询
    User user = findUserByName(username);
    System.out.println("执行了 showModel 方法"+user);
    map.put("abc",user);
}
/**
* 模拟修改用户方法
* @param user
* @return
*/
@RequestMapping("/updateUser")
public String testModelAttribute(@ModelAttribute("abc")User user) {
    System.out.println("控制器中处理请求的方法：修改用户："+user);
    return "success";
}
/**
* 模拟去数据库查询
* @param username
* @return
*/
private User findUserByName(String username) {
    User user = new User();
    user.setUsername(username);
    user.setAge(19);
    user.setPassword("123456");
    return user;
}
```

# 7.SessionAttribute

## 7.1 使用说明

**作用：**用于多次执行控制器方法间的参数共享

**属性：**

​	**value：**用于指定存入的属性名称
​	**type：**用于指定存入的数据类型。

## 7.2 使用示例

**jsp代码**

```jsp
<!-- SessionAttribute 注解的使用 -->
<a href="springmvc/testPut">存入 SessionAttribute</a>
<hr/>
<a href="springmvc/testGet">取出 SessionAttribute</a>
<hr/>
<a href="springmvc/testClean">清除 SessionAttribute</a>
```

**控制器代码**

```java
/**
* SessionAttribute 注解的使用
*/
@Controller("sessionAttributeController")
@RequestMapping("/springmvc")
@SessionAttributes(value ={"username","password"},types={Integer.class})
public class SessionAttributeController {
    /**
    * 把数据存入 SessionAttribute
    * @param model
    * @return
    * Model 是 spring 提供的一个接口，该接口有一个实现类 ExtendedModelMap
    * 该类继承了 ModelMap，而 ModelMap 就是 LinkedHashMap 子类
    */
    @RequestMapping("/testPut")
    public String testPut(Model model){
        model.addAttribute("username", "泰斯特");
        model.addAttribute("password","123456");
        model.addAttribute("age", 31);
        //跳转之前将数据保存到 username、password 和 age 中，因为注解@SessionAttribute 中有
        这几个参数
        return "success";
    }
    
    @RequestMapping("/testGet")
    public String testGet(ModelMap model){
        System.out.println(model.get("username")+";"+model.get("password")+";"+model.get("age"));
        return "success";
    }
    
    @RequestMapping("/testClean")
    public String complete(SessionStatus sessionStatus){
        sessionStatus.setComplete();
        return "success";
    }
}
```

